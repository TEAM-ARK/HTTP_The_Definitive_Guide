# 8μ¥. ν†µν•©μ : κ²μ΄νΈμ›¨μ΄, ν„°λ„, λ¦΄λ μ΄

## κ²μ΄νΈμ›¨μ΄

- μ„λ΅ λ‹¤λ¥Έ λ„¤νΈμ›ν¬λ‚ ν”„λ΅ν† μ½μ΄ ν†µμ‹  κ°€λ¥ν•κ²λ” ν•΄μ£Όλ” μ¥μΉ
  - ex. TTP ν”„λ΅ν† μ½κ³Ό HTTPκ°€ μ•„λ‹ ν”„λ΅ν† μ½μ ν†µμ‹ 
- λ‹¤λ¥Έ λ„¤νΈμ›ν¬λ΅ κ°€κΈ° μ„ν• λ¬Έ
- <ν΄λΌμ΄μ–ΈνΈ ν”„λ΅ν† μ½>/<μ„λ²„ ν”„λ΅ν† μ½> λ΅ κµ¬λ¶„ν•΄μ„ ν‘κΈ°
  - ex. HTTP ν΄λΌμ΄μ–ΈνΈμ™€ FTP μ„λ²„ μ‚¬μ΄μ— κ²μ΄νΈμ›¨μ΄κ°€ μλ‹¤λ©΄ HTTP/FTPλ΅ ν‘κΈ°

### HTTP/\*: μ„λ²„ μΈ΅ μ›Ή κ²μ΄νΈμ›¨μ΄

- μ°Έκ³ λ΅ \*μ€ κΈ°νƒ€ λ‹¤λ¥Έ ν”„λ΅ν† μ½ λ“±μ„ μλ―Έν•¨.
- ν΄λΌμ΄μ–ΈνΈλ΅λ¶€ν„° HTTP μ”μ²­μ΄ μ› μ„λ²„λ΅ λ“¤μ–΄μ¤λ” μ‹μ μ— κ²μ΄νΈμ›¨μ΄κ°€ μ΄ HTTP μ”μ²­μ„ λ‹¤λ¥Έ ν”„λ΅ν† μ½λ΅ μ „ν™

### HTTP/HTTPS: μ„λ²„ μΈ΅ λ³΄μ• κ²μ΄νΈμ›¨μ΄

<img src="./img/http-https-gateway.png" alt="http-https-gateway" />

- κΈ°μ—… λ‚΄λ¶€μ λ¨λ“  μ›Ή μ”μ²­μ„ μ•”νΈν™”ν•¨μΌλ΅μ¨ κ°μΈ μ •λ³΄ λ³΄νΈμ™€ λ³΄μ•μ„ μ κ³µν•λ”λ° μ‚¬μ©

### HTTPS/HTTP: ν΄λΌμ΄μ–ΈνΈ μΈ΅ λ³΄μ• κ°€μ† κ²μ΄νΈμ›¨μ΄

<img src="./img/http-https-client-gateway.png" src="http-https-client-gateway" />

- λ³΄μ• HTTPS νΈλν”½μ„ λ°›μ•„μ„ λ³µνΈν™”ν•κ³ , μ›Ή μ„λ²„λ΅ λ³΄λ‚Ό μΌλ° HTTP μ”μ²­μ„ λ§λ“¦.

### μ• ν”λ¦¬μΌ€μ΄μ… κ²μ΄νΈμ›¨μ΄(λ¦¬μ†μ¤ κ²μ΄νΈμ›¨μ΄)

<img src="./img/application-gateway.png" alt="application-gateway" />

- μ• ν”λ¦¬μΌ€μ΄μ… μ„λ²„λ” κ²μ΄νΈμ›¨μ΄μ μ• ν”λ¦¬μΌ€μ΄μ… ν”„λ΅κ·Έλλ° μΈν„°νμ΄μ¤(API)λ¥Ό ν†µν•΄μ„ μ„λ²„μ—μ„ λ™μ‘ν•κ³  μλ” μ• ν”λ¦¬μΌ€μ΄μ…μ— μ”μ²­μ„ μ „λ‹¬.
- ν”ν μ‚¬μ©ν•κ³  μλ” APIλΌκ³  μƒκ°ν•λ©΄ λ  λ“―.
- μ±…μ— μλ” CGI κ΄€λ ¨ λ‚΄μ©μ€ ν„μ¬ λ”μ΄μƒ μ μ‚¬μ©λμ§€ μ•μ•„μ„ μ„¤λ… μƒλµ

### κ²μ΄νΈμ›¨μ΄μ™€ ν”„λ΅μ‹ μ°¨μ΄μ 

- κ³µν†µμ 
  - ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„μ μ¤‘κ³„ μ—­ν• 
- μ°¨μ΄μ 
  - κ²μ΄νΈμ›¨μ΄λ” μ„λ΅ λ‹¤λ¥Έ ν”„λ΅ν† μ½μ΄ ν†µμ‹  κ°€λ¥ν•λ„λ΅ μ—°κ²°
- κ²°λ΅ 
  - ν”„λ΅ν† μ½μ€ κ°™μ€λ° μ„λ²„ μ£Όμ†κ°€ λ‹¤λ¥΄λ‹¤
    => μ–‘μ½μ—μ„ HTTP ν†µμ‹ μ„ μ‚¬μ©ν•λ‹¤λ©΄ κΈ°μ μ μΌλ΅λ” ν”„λ½μ‹
  - μ„λ΅ λ‹¤λ¥Έ ν”„λ΅ν† μ½μ΄ ν†µμ‹ μ„ ν•λ‹¤
    => κ²μ΄νΈ μ›¨μ΄

## μ• ν”λ¦¬μΌ€μ΄μ… μΈν„°νμ΄μ¤μ™€ μ›Ή μ„λΉ„μ¤

- μ• ν”λ¦¬μΌ€μ΄μ… μΈν„°νμ΄μ¤
  - λ°μ΄ν„°λ¥Ό κµν™ν•λ ¤λ” λ‘ μ• ν”λ¦¬μΌ€μ΄μ… μ‚¬μ΄μ—μ„ ν”„λ΅ν† μ½ μΈν„°νμ΄μ¤λ¥Ό λ§μ¶”λ” κ² κΉλ‹¤λ΅μ›€.
  - λν•, μ• ν”λ¦¬μΌ€μ΄μ…μ΄ μƒνΈ μ΄μ©μ„ ν•λ‹¤λ³΄λ©΄ HTTP ν—¤λ”λ΅λ” ν‘ν„ν•κΈ° νλ“  λ³µμ΅ν• μ •λ³΄λ¥Ό κµν™ν•΄μ•Ό ν•  μλ„ μμ.
  - 19μ¥μ—μ„ http ν™•μ¥μ μμ™€ HTTP μ„μ— ν”„λ΅ν† μ½μ„ λ§μ”μ–΄ μ •λ³΄ κµν™ν•λ” κ²ƒμ— λ€ν•΄ λ°°μΈ κ²ƒ.
- μ›Ή μ„λΉ„μ¤
  - μ• ν”λ¦¬μΌ€μ΄μ…μ„ μ •λ³΄λ¥Ό κ³µμ ν•λ”λ° μ‚¬μ©ν•λ” μ›λ¦¬
  - κ³Όκ±°μ—λ” SOAP(Simple Object Access Protocol)μ„ ν†µν•΄ XMLμ„ μ‚¬μ©ν•μ—¬ μ •λ³΄λ¥Ό κ³µμ ν–μ§€λ§, ν„λ€μ—λ” REST(Representatinal State Transfer)μ™€ JSONμ„ μ£Όλ΅ μ‚¬μ© λ°μ΄ν„° κµν™

## ν„°λ„

- HTTP ν”„λ΅ν† μ½μ„ μ§€μ›ν•μ§€ μ•λ” μ• ν”λ¦¬μΌ€μ΄μ…μ— HTTP μ• ν”λ¦¬μΌ€μ΄μ…μ„ μ‚¬μ©ν•΄ μ ‘κ·Όν•λ” λ°©λ²•μ„ μ κ³µ
  - ν„°λ„μ„ μ‚¬μ©ν•λ” κ°€μ¥ μΌλ°μ μΈ μ΄μ λ” HTTP μ»¤λ„¥μ…μ„ ν†µν•΄μ„ HTTPκ°€ μ•„λ‹ νΈλν”½μ„ μ „μ†΅ν•κΈ° μ„ν• κ²ƒ
  - μ΄ μ™Έ λ‹¤λ¥Έ ν”„λ΅ν† μ½μ„ HTTP μ„μ— μ¬λ¦¬λ” κ²ƒ κ°€λ¥

### CONNECTλ΅ HTTP ν„°λ„ μ»¤λ„¥μ… λ§ΊκΈ°

- ν„°λ„μ€ HTTPμ CONNECT λ©”μ„λ“λ¥Ό μ‚¬μ©ν•μ—¬ μ»¤λ„¥μ…μ„ λ§Ίμ.

    <details>
    <summary>π“CONNECT λ©”μ„λ“λ€?</summary>

  - μ”μ²­ν• λ¦¬μ†μ¤μ— λ€ν•΄ μ–‘λ°©ν–¥ μ—°κ²°μ„ μ‹μ‘ν•λ” λ©”μ†λ“
  - ν„°λ„μ„ μ—΄κΈ° μ„ν•΄μ„ μ‚¬μ©λ  μ μμ.
  </details>

- μ—°κ²° κ³Όμ •
  <img src="./img/connect.png" alt="connection μ—°κ²°"/>

  1. ν΄λΌμ΄μ–ΈνΈλ” κ²μ΄νΈμ›¨μ΄μ— ν„°λ„μ„ μ—°κ²°ν•κΈ° μ„ν•΄ CONNECT μ”μ²­
  2. CONNECT λ©”μ„λ“λ” TCP μ»¤λ„¥μ…μ„ μ„ν•΄ κ²μ΄νΈμ›¨μ΄μ— ν„°λ„ μ—°κ²°μ„ μ”μ²­
  3. TCP μ»¤λ„¥μ…μ΄ λ§Ίμ–΄μ§€λ©΄ κ²μ΄νΈμ›¨μ΄λ” ν΄λΌμ΄μ–ΈνΈμ—κ² 200 μƒνƒλ¥Ό μ „λ‹¬
  4. ν„°λ„μ΄ μ—°κ²°λκ³  λ°μ΄ν„°κ°€ μ „λ‹¬

- CONNECT μ”μ²­

  - μ‹μ‘μ¤„μ μ”μ²­ URIλ” νΈμ¤νΈλ…μ΄ λ€μ‹ ν•λ©° ν¬νΈλ¥Ό κΈ°μ ν•΄μ•Ό ν•¨.
  - CONNECT λ©”μ„λ“μ HTTP λ©”μ‹μ§€λ” μ‹μ‘μ¤„λ§ λ‹¤λ¥΄κ³  λ‚λ¨Έμ§€ HTTP μ”μ²­ ν—¤λ” λ¶€λ¶„μ€ λ‹¤λ¥Έ HTTP λ©”μ„λ“ λ©”μ‹μ§€λ“¤κ³Ό λ™μΌ
    ```
    CONNECT νΈμ¤νΈλ…:ν¬νΈ λ²νΈ HTTPλ²„μ „
    HTTP μ”μ²­ν—¤λ”
    ```
    ex. μ‚¬μ© μμ‹
    ```
    CONNECT home.netscape.com:443 HTTP/1.0
    User-agent: Mozilla/4.0
    ```

- CONNECT μ‘λ‹µ
  - ν΄λΌμ΄μ–ΈνΈλ” μ”μ²­ μ „μ†΅ ν›„, κ²μ΄νΈμ›¨μ΄ μ‘λ‹µμ„ κΈ°λ‹¤λ¦Ό.
  - μΌλ° HTTP λ©”μ‹μ§€μ™€ κ°™μ΄ 200 μ‘λ‹µ μ½”λ“λ” μ„±κ³µμ„ μλ―Έ
  - 200 μƒνƒ μ½”λ“μΌ λ• μ‚¬μ  κµ¬μ μ€ `Connection Established`λ΅ ν‘κΈ°
  - μΌλ°μ μ€ HTTP μ‘λ‹µκ³Όλ” λ‹¬λ¦¬, Content-Type ν—¤λ” ν•„μ” X
  - ex. CONNECT μ‘λ‹µ λ©”μ‹μ§€ ν•νƒ
    ```
    HTTP/1.0 200 Connection Established
    Proxy-agent: Netscape-Proxy/1.1
    ```

### SSL ν„°λ„λ§

![SSL ν„°λ„λ§](https://media.geeksforgeeks.org/wp-content/uploads/20190424191417/SSL-Tunneling.png)

- SSL ν„°λ„λ§μ—λ” ν”„λ΅μ‹ μ„λ²„λ¥Ό ν†µν•΄ λ°±μ—”λ“ μ„λΉ„μ¤ λλ” λ³΄μ• μ„λ²„μ— λ€ν• SSL μ—°κ²°μ΄ ν•„μ”ν• ν΄λΌμ΄μ–ΈνΈκ°€ ν¬ν•¨λ¨.
- μ—¬κΈ°μ„ ν”„λ΅μ‹ μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈμ™€ λ°±μ—”λ“ μ„λΉ„μ¤ κ°„μ μ—°κ²°μ„ μ—΄κ³ , SSL μ—°κ²°μ— μ§μ ‘μ μΈ κ°„μ„­ μ—†μ΄ λ°μ΄ν„°λ¥Ό μ–‘μ½μ— λ³µμ‚¬

- ν„°λ„μ€ μ›λ λ°©ν™”λ²½μ„ ν†µν•΄μ„ μ•”νΈν™”λ SSL νΈλν”½μ„ μ „λ‹¬ν•λ ¤κ³  κ°λ°

#### SSL ν„°λ„λ§μ νΉμ§•

- HTTPS URLμ„ μ‚¬μ©ν•μ—¬ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ κ°„μ— SSL ν„°λ„λ§μ„ μν–‰ν•λ ¤λ©΄ ν΄λΌμ΄μ–ΈνΈκ°€ SSL λ° HTTPSλ¥Ό μ§€μ›ν•΄μ•Ό ν•¨.
  - ν΄λΌμ΄μ–ΈνΈκ°€ HTTPSλ¥Ό μ§€μ›ν•μ§€ μ•λ” κ²½μ° Proxy Serverμ HTTPS ν”„λ΅μ‹ κΈ°λ¥ μ‚¬μ© κ°€λ¥
- SSL ν„°λ„λ§μ λ³΄μ•μ€ ν”„λ΅μ‹λ¥Ό μ‚¬μ©ν•μ§€ μ•λ” SSLκ³Ό λ™λ“±.
  - μ΄λ” ν”„λ΅μ‹ μ„λ²„λ¥Ό μ‚¬μ©ν•΄λ„ SSLμ λ³΄μ•μ΄ μ „ν€ λ³€κ²½λκ±°λ‚ κ°μ†ν•μ§€ μ•μμ„ μλ―Έ
- SSL ν„°λ„λ§μ ν”„λ΅μ‹ μ„λ²„λ” μ•”νΈν™”λμ–΄ μμΌλ―€λ΅ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ κ°„μ νΈλμ­μ…μ— μ•΅μ„Έμ¤ λ¶κ°€λ¥
  - μ΄λ” ν”„λ΅μ‹ μ„λ²„λ‚ μ 3μλ΅λ¶€ν„° λ„μ²­μ΄ λ¶κ°€λ¥ν•¨μ„ μλ―Έ

#### SSL ν„°λ„λ§ vs HTTP/HTTPS κ²μ΄νΈμ›¨μ΄

- HTTP/HTTPS κ²μ΄νΈμ›¨μ΄
  <img src="./img/http-https-gateway.png" alt="HTTP/HTTPS κ²μ΄νΈμ›¨μ΄" />

  - μ›κ²© HTTPS μ„λ²„μ™€ SSL μ„Έμ…μ„ μ‹μ‘ν•λ” κ²μ΄νΈμ›¨μ΄(ν΄λΌμ΄μ–ΈνΈ λ€μ‹ )λ¥Ό λ‘κ³  ν΄λΌμ΄μ–ΈνΈ μΈ΅μ HTTPS νΈλμ­μ…μ„ μν–‰ν•λ” λ°©μ‹
  - μ‘λ‹µμ€ ν”„λ½μ‹κ°€ λ°›μ•„μ„ λ³µνΈν™”ν•κ³  λ‚ ν›„μ— HTTP(λ³΄μ•μ΄ μΆ‹μ§€ μ•μ€, λ³΄μ•μ΄ μ μ©λμ§€ μ•μ€)λ¥Ό ν†µν•΄ ν΄λΌμ΄μ–ΈνΈλ΅ μ „μ†΅

- SSL ν„°λ„λ§
  ![SSL ν„°λ„λ§](https://media.geeksforgeeks.org/wp-content/uploads/20190424192229/Working-of-SSL-Tunneling-Part-1.png)

  - ν”„λ΅μ‹μ— SSLμ„ κµ¬ν„ν•  ν•„μ” X
  - SSL μ„Έμ…μ€ ν΄λΌμ΄μ–ΈνΈκ°€ μƒμ„±ν• μ”μ²­κ³Ό λ©μ μ§€(λ³΄μ•μ΄ μ μ©λ) μ›Ή μ„λ²„ κ°„μ— μƒμ„±
  - ν”„λ½μ‹ μ„λ²„λ” νΈλμ­μ…μΌ λ³΄μ•μ—λ” κ΄€μ—¬ν•μ§€ μ•κ³  μ•”νΈν™”λ λ°μ΄ν„°λ¥Ό κ·Έλ€λ΅ ν„°λ„λ§

### ν„°λ„ μΈμ¦

- HTTPμ λ‹¤λ¥Έ κΈ°λ¥λ“¤μ„ ν„°λ„κ³Ό ν•¨κ» μ‚¬μ© κ°€λ¥
  - ex. ν”„λ΅μ‹ μΈμ¦ κΈ°λ¥ - ν΄λΌμ΄μ–ΈνΈκ°€ ν„°λ„μ„ μ‚¬μ©ν•  μ μλ” κ¶ν•μ„ κ²€μ‚¬ν•λ” μ©λ„

### ν„°λ„ λ³΄μ•μ— λ€ν• κ³ λ ¤μ‚¬ν•­λ“¤

- ν”„λ΅ν† μ½μ΄ ν„°λ„μ„ μ¬λ°”λ¥Έ μ©λ„λ΅ μ‚¬μ©ν•κ³  μλ”μ§€ κ²€μ¦ν•  λ°©λ²•μ΄ X
- ν„°λ„μ μ¤μ©μ„ μµμ†ν™” ν•κΈ° μ„ν•΄ μ μ•λ ¤μ§„ νΉμ • ν¬νΈ(ex. HTTPS μ „μ© ν¬νΈ 443)λ§μ„ ν„°λ„λ§ν•  μ μκ² ν—μ©ν•΄μ•Ό ν•¨.

## λ¦΄λ μ΄

- HTTP λ…μ„Έλ¥Ό μ™„μ „ν μ¤€μν•μ§€λ” μ•λ” κ°„λ‹¨ HTTP ν”„λ΅μ‹
- μ»¤λ„¥μ…μ„ λ§ΊκΈ° μ„ν• HTTP ν†µμ‹ μ„ ν• λ‹¤μ, λ°”μ΄νΈλ¥Ό λ§Ήλ©μ μΌλ΅ μ „λ‹¬ν•¨.
- μ΄ λ•, λ§Ήλ©μ  λ¦΄λ μ΄κ°€ COnnection ν—¤λ”λ¥Ό μ λ€λ΅ μ²λ¦¬ν•μ§€ λ»ν•΄μ„ kepp-alive μ»¤λ„¥μ…μ΄ ν–‰μ— κ±Έλ¦¬λ” λ¬Έμ κ°€ μμ.
- μ΄λ¬ν• λ¬Έμ λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄μ„ HTTPλ¥Ό μ λ€λ΅ μ¤€μν•λ” ν”„λ½μ‹ μ‚¬μ©ν•΄μ•Ό ν•¨.

### λ¦΄λ μ΄μ™€ ν”„λ΅μ‹μ μ°¨μ΄μ 

- κ³µν†µμ 
  - ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ μ‚¬μ΄μ—μ„ λ©”μ‹μ§€λ¥Ό μ „λ‹¬(relay)ν•΄ μ£Όλ” κΈ°λ¥
- μ°¨μ΄μ 
  - λ¦΄λ μ΄
    - ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ μ‚¬μ΄μ λ©”μ„Έμ§€λ¥Ό μ „λ‹¬ν•΄μ£Όλ” κΈ°λ¥μ΄ μ „λ¶€
  - ν”„λ΅μ‹
    - ν΄λΌμ΄μ–ΈνΈμ—κ²λ” proxyκ°€ μ„λ²„μΈ κ²ƒ μ²λΌ λ³΄μ΄κ² ν•κ³ , μ„λ²„μ—κ²λ” proxyκ°€ ν΄λΌμ΄μ–ΈνΈμΈ κ²ƒ μ²λΌ λ³΄μ΄κ² ν•¨.

## μ°Έκ³ 

[SSL ν„°λ„λ§μ΄λ€?](https://www.geeksforgeeks.org/what-is-ssl-tunneling/)  
[CONNECTλ΅ HTTP μ»¤λ„¥μ… λ§ΊκΈ°](https://tigger.dev/entry/network-gateway-tunnel-relay)  
[ν”„λ΅μ‹μ™€ κ²μ΄νΈμ›¨μ΄ μ°¨μ΄μ ](https://swimjiy.github.io/2020-04-11-web-gateway)  
[ν”„λ΅μ‹ μ„λ²„μ™€ λ¦΄λ μ΄ μ„λ²„μ μ°¨μ΄μ ](https://velog.io/@ghkstmd00/%ED%94%84%EB%A1%9D%EC%8B%9C%EC%84%9C%EB%B2%84%EC%99%80-%EB%A6%B4%EB%A0%88%EC%9D%B4-%EC%84%9C%EB%B2%84%EC%9D%98-%EC%B0%A8%EC%9D%B4%EC%A0%90)  
[CONNECT λ©”μ„λ“](https://developer.mozilla.org/ko/docs/Web/HTTP/Methods/CONNECT)
